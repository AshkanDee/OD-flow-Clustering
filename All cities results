      city algorithm minPts eps n_clusters noise_pct max_cluster_pct
1   berlin    DBSCAN     20 0.2         81 32.377742        65.87999
2   berlin    DBSCAN     20 0.3         29 12.993661        84.55888
3   berlin    DBSCAN     20 0.4         10  6.033223        92.05195
4   berlin    DBSCAN     20 0.5          6  3.225120        94.68174
5   berlin    DBSCAN     20 0.6          2  1.936107        96.41423
6   berlin    DBSCAN     30 0.2         49 41.014875        56.97194
7   berlin    DBSCAN     30 0.3         18 16.851496        81.36712
8   berlin    DBSCAN     30 0.4          4  7.983135        90.39654
9   berlin    DBSCAN     30 0.5          3  4.221358        93.80400
10  berlin    DBSCAN     30 0.6          3  2.501524        95.36278
11  berlin    DBSCAN     50 0.2         33 54.355379        43.76143
12  berlin    DBSCAN     50 0.3          8 22.564336        76.54296
13  berlin    DBSCAN     50 0.4          7 11.322144        86.50937
14  berlin    DBSCAN     50 0.5          3  5.893451        92.31424
15  berlin    DBSCAN     50 0.6          3  3.394227        94.57131
16  munich    DBSCAN     20 0.2         64 25.017781        73.98978
17  munich    DBSCAN     20 0.3         39 11.989238        87.37064
18  munich    DBSCAN     20 0.4         29  6.000408        93.45595
19  munich    DBSCAN     20 0.5         18  3.289390        96.29268
20  munich    DBSCAN     20 0.6         10  2.069791        97.49574
21  munich    DBSCAN     30 0.2         24 30.089154        69.25749
22  munich    DBSCAN     30 0.3         11 14.691434        85.02903
23  munich    DBSCAN     30 0.4         16  7.829807        91.75171
24  munich    DBSCAN     30 0.5         12  4.426838        95.21037
25  munich    DBSCAN     30 0.6          8  2.671871        96.96423
26  munich    DBSCAN     50 0.2         11 37.331767        62.24534
27  munich    DBSCAN     50 0.3          5 18.456644        81.35645
28  munich    DBSCAN     50 0.4          4 10.726632        89.09363
29  munich    DBSCAN     50 0.5          5  6.150928        93.64617
30  munich    DBSCAN     50 0.6          6  3.832476        95.91831
31 cologne    DBSCAN     20 0.2         48 36.537034        52.61371
32 cologne    DBSCAN     20 0.3         14 15.066648        74.20778
33 cologne    DBSCAN     20 0.4          6  7.678989        92.09015
34 cologne    DBSCAN     20 0.5          8  4.250378        95.43493
35 cologne    DBSCAN     20 0.6          4  2.439192        97.45774
36 cologne    DBSCAN     30 0.2         39 45.370345        44.47712
37 cologne    DBSCAN     30 0.3         18 20.111310        68.34685
38 cologne    DBSCAN     30 0.4          4  9.668820        90.18552
39 cologne    DBSCAN     30 0.5          3  5.598461        94.29710
40 cologne    DBSCAN     30 0.6          3  3.336540        96.51917
41 cologne    DBSCAN     50 0.2         21 58.742614        32.26879
42 cologne    DBSCAN     50 0.3         11 27.736705        61.69163
43 cologne    DBSCAN     50 0.4          3 13.748798        86.16051
44 cologne    DBSCAN     50 0.5          1  7.901608        92.09839
45 cologne    DBSCAN     50 0.6          1  4.850900        95.14910


--- BERLIN ---

    0     1     2     3     4     5     6     7     8     9    10    11    12 
71306 99048   114    31  1210   126    47    54    69   142    51    37   140 
   13    14    15    16    17    18    19    20    21    22    23    24    25 
   83    65    34    37    76    78    52    49    55    86   111    31    37 
   26    27    28    29    30    31    32    33    34    35    36    37    38 
   34    42    29    26    25    44    30    39    29    28    38    28    29 
   39    40    41    42    43    44    45    46    47    48    49 
   22     7    30    19    24    31    15    36    24    26    30 

--- MUNICH ---

     0      1      2      3      4      5      6      7      8      9     10 
 54573 125613     29     46     60     49     75     54     58     43     54 
    11     12     13     14     15     16     17     18     19     20     21 
    87     57     71     41     33     40    179     45     20     37     26 
    22     23     24 
    26     28     27 

--- COLOGNE ---

    0     1     2     3     4     5     6     7     8     9    10    11    12 
14635 49736  6617   421   562    44   290    44    55    22    35    59    74 
   13    14    15    16    17    18 
   36    28    30    34    19    29 


--- BERLIN ---
# A tibble: 15 × 8
   cluster  size mean_x_o mean_y_o  mean_dx  mean_dy mean_len mean_duration
     <int> <int>    <dbl>    <dbl>    <dbl>    <dbl>    <dbl>         <dbl>
 1       1 99048  797589. 5826268.     1.39    0.144     650.          4.83
 2       4  1210  803061. 5818455.    19.8   -14.2       528.          3.96
 3       9   142  795351. 5818485.  -422.   -406.        593.          3.73
 4      12   140  805797. 5816941.   474.    350.        616.          4.66
 5       5   126  799593. 5813229.   127.   -487.        538.          3.34
 6       2   114  804450. 5822053.   356.    357.        529.          3.46
 7      23   111  795122. 5818260.   354.    385.        532.          3.52
 8      22    86  799639. 5813374.   620.    145.        643.          4.47
 9      13    83  806206. 5817250.  -452.   -287.        550.          3.58
10      18    78  802176. 5832085.   102.   -485.        506.          3.40
11      17    76  800284. 5813295.  -666.   -124.        681.          5.96
12       8    69  799255. 5812680.    34.1   488.        491.          3.31
13      14    65  802042. 5831477.   -85.9   449.        468.          3.40
14      21    55  795141. 5827087.  1861.    294.       1888.         14.1 
15       7    54  804799. 5825369. -1490.    957.       1773.          9.28

--- MUNICH ---
# A tibble: 15 × 8
   cluster   size mean_x_o mean_y_o   mean_dx   mean_dy mean_len mean_duration
     <int>  <int>    <dbl>    <dbl>     <dbl>     <dbl>    <dbl>         <dbl>
 1       1 134196  691012. 5335286.    -0.865      1.68    277.          20.1 
 2      29    179  698874. 5345531.   -11.0        8.19     22.1       3240.  
 3       5     85  698438. 5333996.  -409.       584.      759.           6.44
 4      17     82  699629. 5335494.   501.      -817.      972.           6.36
 5      12     57  687711. 5334308.  -664.      -666.      952.           5.80
 6      16     56  691203. 5341383.   795.       -43.4     810.           4.96
 7      49     47  690687. 5334792.  -685.     -1599.     1749.          23.9 
 8      30     45  698863. 5345539. -8351.    -10504.    13419.         940.  
 9       2     42  696535. 5334906.  -577.      -304.      666.          15.7 
10      15     38  686361. 5339378.  1785.       461.     1850.          12.4 
11      31     38  689488. 5333045.  1313.      1680.     2134.         159.  
12      26     37  687379. 5340030.  -903.      -648.     1119.          42.1 
13      35     35  692651. 5339645.  -301.     -2148.     2172.          89.7 
14      22     34  692014. 5341213.  -848.       187.      879.           4.92
15      13     33  688316. 5336490. -1687.       -23.6    1690.           8.69

--- COLOGNE ---
# A tibble: 15 × 8
   cluster  size mean_x_o mean_y_o  mean_dx   mean_dy mean_len mean_duration
     <int> <int>    <dbl>    <dbl>    <dbl>     <dbl>    <dbl>         <dbl>
 1       1 49736  356713. 5645399.     6.72   -14.1       916.          7.01
 2       2  6617  363733. 5639276.    17.3     -3.31      778.          5.69
 3       4   562  359148. 5639283.    23.3    -15.2       638.          5.06
 4       3   421  353512. 5651412.   -89.7     -0.246     566.          4.52
 5       6   290  347857. 5645238.   -44.2     93.6       591.          4.52
 6      12    74  359481. 5647187. -1794.   -2072.       2747.         17.3 
 7      11    59  357531. 5644726.   999.   -2310.       2527.         11.8 
 8       8    55  350013. 5643975.   190.     978.       1015.          5.63
 9       5    44  353798. 5646239. -2169.    2007.       2960.         13.7 
10       7    44  353382. 5648232.   302.   -1689.       1730.         12.4 
11      13    36  359156. 5642345.   581.    2353.       2428.         15.4 
12      10    35  359623. 5636671.  -145.     191.        319.          2.84
13      16    34  356240. 5647906.  -589.    1521.       1646.          8.37
14      15    30  357769. 5645033.  2155.    2358.       3202.         18.2 
15      18    29  359231. 5644883. -2766.    -162.       2775.         19.3 

To prevent a single city-wide cluster from masking secondary patterns,
the dominant cluster (by size) is excluded from the multi-objective analysis when it accounts for a disproportionate share of flows.

CITY: BERLIN | f1 = -3493 | f2 = -0.3412913 
CITY: MUNICH | f1 = -1185 | f2 = -0.2283712 
CITY: COLOGNE | f1 = -8399 | f2 = -0.7713259 

Extreme solutions were evaluated to verify correct penalty handling and objective scaling prior to multi-objective optimization.

# Random solution sampling 

CITY: BERLIN 
     city            covered_size    dir_concentration 
 Length:500         Min.   :  95.0   Min.   :0.003476  
 Class :character   1st Qu.: 385.0   1st Qu.:0.218104  
 Mode  :character   Median : 503.5   Median :0.357804  
                    Mean   : 723.7   Mean   :0.402962  
                    3rd Qu.: 743.5   3rd Qu.:0.596219  
                    Max.   :2137.0   Max.   :0.974259  

CITY: MUNICH 
     city            covered_size   dir_concentration
 Length:500         Min.   : 26.0   Min.   :-1.0000  
 Class :character   1st Qu.:155.0   1st Qu.: 0.2985  
 Mode  :character   Median :224.5   Median : 0.4634  
                    Mean   :239.7   Mean   : 0.4399  
                    3rd Qu.:315.2   3rd Qu.: 0.6355  
                    Max.   :642.0   Max.   : 0.9988  

CITY: COLOGNE 
     city            covered_size    dir_concentration
 Length:500         Min.   :   0.0   Min.   :-1.0000  
 Class :character   1st Qu.: 116.8   1st Qu.: 0.3571  
 Mode  :character   Median : 444.5   Median : 0.7740  
                    Mean   :1721.0   Mean   : 0.5143  
                    3rd Qu.: 963.5   3rd Qu.: 0.9153  
                    Max.   :7970.0   Max.   : 1.0000  

# Pareto front summary
--- BERLIN ---
 covered_demand dir_concentration
 Min.   :1355   Min.   :0.3413   
 1st Qu.:1970   1st Qu.:0.5196   
 Median :2497   Median :0.7153   
 Mean   :2489   Mean   :0.6962   
 3rd Qu.:3022   3rd Qu.:0.8763   
 Max.   :3493   Max.   :0.9948   

--- MUNICH ---
 covered_demand   dir_concentration
 Min.   :  66.0   Min.   :0.2284   
 1st Qu.: 548.8   1st Qu.:0.4404   
 Median : 777.5   Median :0.6365   
 Mean   : 749.3   Mean   :0.6307   
 3rd Qu.: 974.5   3rd Qu.:0.8179   
 Max.   :1185.0   Max.   :1.0000   

--- COLOGNE ---
 covered_demand dir_concentration
 Min.   :6639   Min.   :0.7713   
 1st Qu.:7496   1st Qu.:0.8248   
 Median :7819   Median :0.8964   
 Mean   :7777   Mean   :0.8925   
 3rd Qu.:8090   3rd Qu.:0.9595   
 Max.   :8399   Max.   :1.0000   


# Knee Point selection for pareto front(Used only to select one representative solution per city)
--- BERLIN ---
Knee index: 52 
   covered_demand dir_concentration
52           2431         0.7449101

--- MUNICH ---
Knee index: 62 
   covered_demand dir_concentration
62            675         0.7251668

--- COLOGNE ---
Knee index: 73 
   covered_demand dir_concentration
73           7596          0.941061

# Extreme and knee pareto solution
--- BERLIN ---
Best direction solution:
  covered_demand dir_concentration
2           1355         0.9947567
Best coverage solution:
  covered_demand dir_concentration
1           3493         0.3412913
Knee solution:
   covered_demand dir_concentration
52           2431         0.7449101

--- MUNICH ---
Best direction solution:
  covered_demand dir_concentration
2             66         0.9999934
Best coverage solution:
  covered_demand dir_concentration
1           1185         0.2283712
Knee solution:
   covered_demand dir_concentration
62            675         0.7251668

--- COLOGNE ---
Best direction solution:
  covered_demand dir_concentration
1           6639         0.9999654
Best coverage solution:
  covered_demand dir_concentration
2           8399         0.7713259
Knee solution:
   covered_demand dir_concentration
73           7596          0.941061

# Decode NSGA-II solutions into cluster IDs
====================
CITY: BERLIN 
====================
best_dir clusters:
4, 6, 28, 35, 29, 45 
best_cov clusters:
4, 9, 12, 5, 2, 23, 22, 13, 18, 17, 8, 14, 21, 7, 19, 10, 20, 6, 31, 27, 33, 36, 11, 16, 25, 46, 15, 26, 3, 24, 44, 32, 41, 49, 28, 34, 38, 35, 37, 29, 48, 30, 43, 47, 39, 42, 45 
knee clusters:
4, 12, 5, 2, 23, 22, 18, 21, 6, 31, 33, 36, 25, 15, 3, 32, 41, 49, 28, 38, 35, 29, 43, 45 

====================
CITY: MUNICH 
====================
best_dir clusters:
20, 2 
best_cov clusters:
17, 11, 6, 13, 4, 8, 12, 7, 10, 5, 3, 18, 9, 14, 16, 20, 15, 2, 23, 24, 21, 22, 19 
knee clusters:
17, 11, 6, 4, 8, 10, 5, 20, 2, 24, 19 

====================
CITY: COLOGNE 
====================
best_dir clusters:
2, 9 
best_cov clusters:
2, 4, 3, 6, 12, 11, 8, 5, 7, 13, 10, 16, 15, 18, 14, 9, 17 
knee clusters:
2, 4, 12, 11, 8, 7, 13, 10, 16, 15, 14, 9 

# Knee solution table

====================
CITY: BERLIN 
====================

Best direction solution (top 10 clusters):
# A tibble: 6 × 6
  cluster  size mean_dx mean_dy mean_len mean_duration
    <int> <int>   <dbl>   <dbl>    <dbl>         <dbl>
1       4  1210    19.8   -14.2     528.          3.96
2       6    47  1326.   -928.     1624.          8.92
3      28    29   321.   -266.      424.          2.55
4      35    28   721.   -594.      936.          5.47
5      29    26   369.  -1185.     1246.          6.08
6      45    15   258.    -33.8     267.          3.47

Knee solution (top 10 clusters):
# A tibble: 10 × 6
   cluster  size mean_dx mean_dy mean_len mean_duration
     <int> <int>   <dbl>   <dbl>    <dbl>         <dbl>
 1       4  1210    19.8   -14.2     528.          3.96
 2      12   140   474.    350.      616.          4.66
 3       5   126   127.   -487.      538.          3.34
 4       2   114   356.    357.      529.          3.46
 5      23   111   354.    385.      532.          3.52
 6      22    86   620.    145.      643.          4.47
 7      18    78   102.   -485.      506.          3.40
 8      21    55  1861.    294.     1888.         14.1 
 9       6    47  1326.   -928.     1624.          8.92
10      31    44   -51.9 -1023.     1029.          6.60

Best coverage solution (top 10 clusters):
# A tibble: 10 × 6
   cluster  size mean_dx mean_dy mean_len mean_duration
     <int> <int>   <dbl>   <dbl>    <dbl>         <dbl>
 1       4  1210    19.8   -14.2     528.          3.96
 2       9   142  -422.   -406.      593.          3.73
 3      12   140   474.    350.      616.          4.66
 4       5   126   127.   -487.      538.          3.34
 5       2   114   356.    357.      529.          3.46
 6      23   111   354.    385.      532.          3.52
 7      22    86   620.    145.      643.          4.47
 8      13    83  -452.   -287.      550.          3.58
 9      18    78   102.   -485.      506.          3.40
10      17    76  -666.   -124.      681.          5.96

====================
CITY: MUNICH 
====================

Best direction solution (top 10 clusters):
# A tibble: 2 × 6
  cluster  size mean_dx mean_dy mean_len mean_duration
    <int> <int>   <dbl>   <dbl>    <dbl>         <dbl>
1      20    37    694.    742.    1021.         89.6 
2       2    29    502.    544.     747.          4.03

Knee solution (top 10 clusters):
# A tibble: 10 × 6
   cluster  size mean_dx mean_dy mean_len mean_duration
     <int> <int>   <dbl>   <dbl>    <dbl>         <dbl>
 1      17   179   -11.0    8.19     22.1       3240.  
 2      11    87  -554.   860.     1042.          10.1 
 3       6    75  -479.   490.      728.           4.35
 4       4    60   626.   376.      742.          54.8 
 5       8    58   321.  1970.     2000.          12.6 
 6      10    54   540.   687.      883.          37.0 
 7       5    49   517.  2624.     2676.          67.8 
 8      20    37   694.   742.     1021.          89.6 
 9       2    29   502.   544.      747.           4.03
10      24    27   660.   213.      702.           4.04

Best coverage solution (top 10 clusters):
# A tibble: 10 × 6
   cluster  size mean_dx mean_dy mean_len mean_duration
     <int> <int>   <dbl>   <dbl>    <dbl>         <dbl>
 1      17   179   -11.0    8.19     22.1       3240.  
 2      11    87  -554.   860.     1042.          10.1 
 3       6    75  -479.   490.      728.           4.35
 4      13    71   477.  -812.      952.           5.72
 5       4    60   626.   376.      742.          54.8 
 6       8    58   321.  1970.     2000.          12.6 
 7      12    57   783.   -46.9     794.           4.84
 8       7    54  1224.   244.     1255.          12.0 
 9      10    54   540.   687.      883.          37.0 
10       5    49   517.  2624.     2676.          67.8 

====================
CITY: COLOGNE 
====================

Best direction solution (top 10 clusters):
# A tibble: 2 × 6
  cluster  size mean_dx mean_dy mean_len mean_duration
    <int> <int>   <dbl>   <dbl>    <dbl>         <dbl>
1       2  6617    17.3   -3.31     778.          5.69
2       9    22  2174.   -96.9     2178.         13.3 

Knee solution (top 10 clusters):
# A tibble: 10 × 6
   cluster  size mean_dx  mean_dy mean_len mean_duration
     <int> <int>   <dbl>    <dbl>    <dbl>         <dbl>
 1       2  6617    17.3    -3.31     778.          5.69
 2       4   562    23.3   -15.2      638.          5.06
 3      12    74 -1794.  -2072.      2747.         17.3 
 4      11    59   999.  -2310.      2527.         11.8 
 5       8    55   190.    978.      1015.          5.63
 6       7    44   302.  -1689.      1730.         12.4 
 7      13    36   581.   2353.      2428.         15.4 
 8      10    35  -145.    191.       319.          2.84
 9      16    34  -589.   1521.      1646.          8.37
10      15    30  2155.   2358.      3202.         18.2 

Best coverage solution (top 10 clusters):
# A tibble: 10 × 6
   cluster  size mean_dx   mean_dy mean_len mean_duration
     <int> <int>   <dbl>     <dbl>    <dbl>         <dbl>
 1       2  6617    17.3    -3.31      778.          5.69
 2       4   562    23.3   -15.2       638.          5.06
 3       3   421   -89.7    -0.246     566.          4.52
 4       6   290   -44.2    93.6       591.          4.52
 5      12    74 -1794.  -2072.       2747.         17.3 
 6      11    59   999.  -2310.       2527.         11.8 
 7       8    55   190.    978.       1015.          5.63
 8       5    44 -2169.   2007.       2960.         13.7 
 9       7    44   302.  -1689.       1730.         12.4 
10      13    36   581.   2353.       2428.         15.4 

# Covered demand of selected Pareto solutions

====================
CITY: BERLIN 
====================
Covered demand (sum of cluster sizes):
  Best direction : 1355 
  Knee solution  : 2431 
  Best coverage  : 3493 

====================
CITY: MUNICH 
====================
Covered demand (sum of cluster sizes):
  Best direction : 66 
  Knee solution  : 675 
  Best coverage  : 1185 

====================
CITY: COLOGNE 
====================
Covered demand (sum of cluster sizes):
  Best direction : 6639 
  Knee solution  : 7596 
  Best coverage  : 8399 

#      Percent coverage + cross-city summary
city             total_clustered_demand covered_best_direction pct_best_direction
1  berlin                 102541                   1355         1.32142265
2 cologne                  58135                   6639        11.41997076
3  munich                 126798                     66         0.05205129
    covered_knee   pct_knee       covered_best_coverage pct_best_coverage
1         2431  2.3707590                  3493         3.4064423
2         7596 13.0661392                  8399        14.4474069
3          675  0.5323428                  1185         0.9345573

#HDBSCAN Python
No OD records were removed due to missing values in the clustering features in any city (Berlin n=173,854; Munich dropped about 40,000 n=181,371; Cologne n=72,770).”

[BERLIN] HDBSCAN done | minPts=10
  Clusters (excluding noise=0): 1366
  Noise share: 0.7357380330622246
  Top 15 cluster sizes (label, size):
  [(0, 127911), (1, 3125), (2, 942), (7, 611), (954, 399), (1366, 381), (87, 271), (18, 264), (442, 255), (785, 252), (965, 245), (757, 236), (641, 218), (1018, 208), (1114, 208)]

[BERLIN] HDBSCAN done | minPts=15
  Clusters (excluding noise=0): 43
  Noise share: 0.03307948048362419
  Top 15 cluster sizes (label, size):
  [(10, 161843), (0, 5751), (1, 3125), (2, 943), (6, 595), (9, 263), (7, 248), (17, 68), (38, 65), (3, 52), (26, 48), (36, 47), (43, 47), (30, 43), (12, 38)]

[BERLIN] HDBSCAN done | minPts=20
  Clusters (excluding noise=0): 31
  Noise share: 0.038756657885352076
  Top 15 cluster sizes (label, size):
  [(10, 161045), (0, 6738), (1, 3126), (3, 941), (5, 597), (6, 274), (8, 152), (14, 95), (13, 68), (21, 68), (29, 65), (18, 54), (2, 49), (16, 48), (17, 46)]

[BERLIN] HDBSCAN done | minPts=25
  Clusters (excluding noise=0): 24
  Noise share: 0.03987253672621855
  Top 15 cluster sizes (label, size):
  [(8, 160946), (0, 6932), (1, 3126), (2, 943), (6, 588), (7, 273), (4, 242), (10, 72), (22, 68), (18, 66), (24, 65), (17, 53), (3, 49), (20, 49), (12, 48)]

[BERLIN] HDBSCAN done | minPts=30
  Clusters (excluding noise=0): 23
  Noise share: 0.13158742393042439
  Top 15 cluster sizes (label, size):
  [(23, 144452), (0, 22877), (1, 3125), (2, 942), (4, 823), (21, 271), (7, 258), (22, 189), (6, 154), (9, 91), (15, 89), (17, 68), (10, 67), (18, 65), (3, 49)]

[BERLIN] HDBSCAN done | minPts=50
  Clusters (excluding noise=0): 10
  Noise share: 0.04746511440634095
  Top 15 cluster sizes (label, size):
  [(10, 159818), (0, 8252), (1, 3125), (2, 943), (3, 804), (9, 257), (7, 164), (8, 160), (4, 155), (6, 119), (5, 57)]
/usr/local/lib/python3.12/dist-packages/hdbscan/hdbscan_.py:1509: RuntimeWarning: invalid value encountered in scalar divide
  self._outlier_scores = outlier_scores(self._condensed_tree)

[MUNICH] HDBSCAN done | minPts=10
  Clusters (excluding noise=0): 3177
  Noise share: 0.5680180403702907
  Top 15 cluster sizes (label, size):
  [(0, 103022), (1409, 230), (3, 161), (3049, 155), (2512, 152), (3121, 145), (1388, 143), (1536, 141), (531, 140), (2201, 138), (2903, 132), (2252, 126), (510, 118), (2516, 118), (3172, 118)]
/usr/local/lib/python3.12/dist-packages/hdbscan/hdbscan_.py:1509: RuntimeWarning: invalid value encountered in scalar divide
  self._outlier_scores = outlier_scores(self._condensed_tree)

[MUNICH] HDBSCAN done | minPts=15
  Clusters (excluding noise=0): 1868
  Noise share: 0.6218359054093543
  Top 15 cluster sizes (label, size):
  [(0, 112783), (3, 159), (961, 156), (413, 146), (1811, 145), (1863, 144), (602, 143), (1069, 141), (1200, 141), (89, 140), (315, 140), (1011, 139), (1175, 138), (1370, 138), (1692, 138)]
/usr/local/lib/python3.12/dist-packages/hdbscan/hdbscan_.py:1509: RuntimeWarning: invalid value encountered in scalar divide
  self._outlier_scores = outlier_scores(self._condensed_tree)

[MUNICH] HDBSCAN done | minPts=20
  Clusters (excluding noise=0): 1262
  Noise share: 0.6568359881127633
  Top 15 cluster sizes (label, size):
  [(0, 119131), (70, 247), (1043, 243), (661, 239), (369, 229), (240, 228), (1208, 226), (4, 225), (518, 206), (860, 206), (651, 202), (278, 198), (1069, 196), (520, 191), (1255, 176)]
/usr/local/lib/python3.12/dist-packages/hdbscan/hdbscan_.py:1509: RuntimeWarning: invalid value encountered in scalar divide
  self._outlier_scores = outlier_scores(self._condensed_tree)

[MUNICH] HDBSCAN done | minPts=25
  Clusters (excluding noise=0): 927
  Noise share: 0.67580263658468
  Top 15 cluster sizes (label, size):
  [(0, 122571), (493, 416), (644, 361), (738, 285), (927, 283), (657, 269), (915, 259), (534, 249), (47, 240), (251, 237), (330, 231), (298, 225), (4, 224), (200, 224), (387, 211)]
/usr/local/lib/python3.12/dist-packages/hdbscan/hdbscan_.py:1509: RuntimeWarning: invalid value encountered in scalar divide
  self._outlier_scores = outlier_scores(self._condensed_tree)

[MUNICH] HDBSCAN done | minPts=30
  Clusters (excluding noise=0): 720
  Noise share: 0.6862067254412227
  Top 15 cluster sizes (label, size):
  [(0, 124458), (456, 418), (128, 394), (695, 391), (474, 383), (431, 372), (313, 317), (71, 303), (530, 289), (555, 286), (550, 268), (172, 262), (714, 255), (368, 252), (426, 250)]

[MUNICH] HDBSCAN done | minPts=50
  Clusters (excluding noise=0): 362
  Noise share: 0.7191116551157573
  Top 15 cluster sizes (label, size):
  [(0, 130426), (12, 3273), (245, 1011), (209, 833), (341, 766), (9, 473), (19, 468), (177, 461), (305, 438), (229, 432), (87, 402), (275, 382), (11, 376), (219, 372), (136, 371)]

[COLOGNE] HDBSCAN done | minPts=10
  Clusters (excluding noise=0): 2
  Noise share: 0.0
  Top 15 cluster sizes (label, size):
  [(2, 72602), (1, 168)]

[COLOGNE] HDBSCAN done | minPts=15
  Clusters (excluding noise=0): 2
  Noise share: 0.0
  Top 15 cluster sizes (label, size):
  [(2, 72602), (1, 168)]

[COLOGNE] HDBSCAN done | minPts=20
  Clusters (excluding noise=0): 2
  Noise share: 0.0
  Top 15 cluster sizes (label, size):
  [(2, 72602), (1, 168)]

[COLOGNE] HDBSCAN done | minPts=25
  Clusters (excluding noise=0): 2
  Noise share: 0.0
  Top 15 cluster sizes (label, size):
  [(2, 72602), (1, 168)]

[COLOGNE] HDBSCAN done | minPts=30
  Clusters (excluding noise=0): 2
  Noise share: 0.0
  Top 15 cluster sizes (label, size):
  [(2, 72602), (1, 168)]

[COLOGNE] HDBSCAN done | minPts=50
  Clusters (excluding noise=0): 2
  Noise share: 2.7483853236223717e-05
  Top 15 cluster sizes (label, size):
  [(2, 72600), (1, 168), (0, 2)]

=== Combined summary (all cities) ===
city	algorithm	minPts	n_clusters	noise_share	clustered_share	top15_sizes
0	berlin	HDBSCAN	10	1366	0.735738	0.264262	[(0, 127911), (1, 3125), (2, 942), (7, 611), (...
1	berlin	HDBSCAN	15	43	0.033079	0.966921	[(10, 161843), (0, 5751), (1, 3125), (2, 943),...
2	berlin	HDBSCAN	20	31	0.038757	0.961243	[(10, 161045), (0, 6738), (1, 3126), (3, 941),...
3	berlin	HDBSCAN	25	24	0.039873	0.960127	[(8, 160946), (0, 6932), (1, 3126), (2, 943), ...
4	berlin	HDBSCAN	30	23	0.131587	0.868413	[(23, 144452), (0, 22877), (1, 3125), (2, 942)...
5	berlin	HDBSCAN	50	10	0.047465	0.952535	[(10, 159818), (0, 8252), (1, 3125), (2, 943),...
6	munich	HDBSCAN	10	3177	0.568018	0.431982	[(0, 103022), (1409, 230), (3, 161), (3049, 15...
7	munich	HDBSCAN	15	1868	0.621836	0.378164	[(0, 112783), (3, 159), (961, 156), (413, 146)...
8	munich	HDBSCAN	20	1262	0.656836	0.343164	[(0, 119131), (70, 247), (1043, 243), (661, 23...
9	munich	HDBSCAN	25	927	0.675803	0.324197	[(0, 122571), (493, 416), (644, 361), (738, 28...
10	munich	HDBSCAN	30	720	0.686207	0.313793	[(0, 124458), (456, 418), (128, 394), (695, 39...
11	munich	HDBSCAN	50	362	0.719112	0.280888	[(0, 130426), (12, 3273), (245, 1011), (209, 8...
12	cologne	HDBSCAN	10	2	0.000000	1.000000	[(2, 72602), (1, 168)]
13	cologne	HDBSCAN	15	2	0.000000	1.000000	[(2, 72602), (1, 168)]
14	cologne	HDBSCAN	20	2	0.000000	1.000000	[(2, 72602), (1, 168)]
15	cologne	HDBSCAN	25	2	0.000000	1.000000	[(2, 72602), (1, 168)]
16	cologne	HDBSCAN	30	2	0.000000	1.000000	[(2, 72602), (1, 168)]
17	cologne	HDBSCAN	50	2	0.000027	0.999973	[(2, 72600), (1, 168), (0, 2)]

Methods (HDBSCAN configuration)

“HDBSCAN was applied to standardized 4D OD representations. To assess robustness, we varied the minimum cluster size (minPts) while keeping all other parameters fixed.”

Results (Cologne)

“Across all tested minPts values, Cologne consistently yielded only two stable clusters with near-zero noise.
Diagnostic checks confirmed that this behavior was not driven by OD duplication or coordinate snapping.
Instead, it reflects a highly compact and globally dense OD flow structure, in which most trips remain density-connected under strict clustering thresholds.”

Results (cross-city comparison)

“In contrast, Berlin exhibited a multi-modal density structure with a clear trade-off between cluster count and coverage,
while Munich showed strong local density pockets but high overall fragmentation, resulting in many small clusters and a large fraction of noise points.”

=== Pareto table (all cities) ===
city	algorithm	minPts	clustered_share	directional_cohesion
0	berlin	HDBSCAN	10	0.264262	0.764423
1	berlin	HDBSCAN	15	0.966921	0.009553
2	berlin	HDBSCAN	20	0.961243	0.008827
3	berlin	HDBSCAN	25	0.960127	0.007713
4	berlin	HDBSCAN	30	0.868413	0.007488
5	berlin	HDBSCAN	50	0.952535	0.005100
12	cologne	HDBSCAN	10	1.000000	0.004212
13	cologne	HDBSCAN	15	1.000000	0.004212
14	cologne	HDBSCAN	20	1.000000	0.004212
15	cologne	HDBSCAN	25	1.000000	0.004212
16	cologne	HDBSCAN	30	1.000000	0.004212
17	cologne	HDBSCAN	50	0.999973	0.004210
6	munich	HDBSCAN	10	0.431982	0.309572
7	munich	HDBSCAN	15	0.378164	0.229166
8	munich	HDBSCAN	20	0.343164	0.182045
9	munich	HDBSCAN	25	0.324197	0.149064
10	munich	HDBSCAN	30	0.313793	0.132562
11	munich	HDBSCAN	50	0.280888	0.084253


“For Berlin, HDBSCAN yields a clear two-regime trade-off.
At minPts=10, the algorithm identifies many small, directionally coherent clusters but assigns the majority of flows to noise (clustered share ≈ 0.26; cohesion ≈ 0.76).
Increasing minPts to 15 produces near-complete coverage (clustered share ≈ 0.97) but
substantially reduces directional cohesion (≈ 0.01), indicating that clusters become directionally heterogeneous.
All intermediate and higher minPts settings are dominated by the minPts=15 solution.”

For Munich, all tested parameterizations form a monotonic deterioration curve in which both clustered share and directional cohesion decrease with increasing minPts.
Consequently, the Pareto front collapses to a single non-dominated solution (minPts=10), indicating the absence of a meaningful multi-objective trade-off.

“For Cologne, HDBSCAN yields near-complete coverage and almost constant directional cohesion across all tested minPts values.
As a result, the Pareto front degenerates into a flat, trivial set, indicating a single dominant OD structure with no meaningful coverage–cohesion trade-off.”

Multi-objective OD clustering is city-dependent.
It is informative only when the underlying OD system exhibits competing structural objectives.

“While Berlin exhibits a clear Pareto trade-off between clustered share and directional cohesion, Munich and Cologne do not.
In Munich, both objectives deteriorate monotonically with increasing minPts, collapsing the Pareto front to a single solution.
In Cologne, both objectives remain nearly constant across all parameterizations, yielding a trivial Pareto front.
These findings indicate that meaningful multi-objective OD clustering emerges only in cities with sufficiently heterogeneous flow structures.”

“Figure X illustrates the Pareto fronts obtained for Berlin, Munich, and Cologne. 
Berlin exhibits a clear two-point Pareto front, revealing a pronounced trade-off between clustered share and directional cohesion:
a low-coverage but highly directionally consistent solution (minPts = 10) versus a high-coverage but directionally heterogeneous solution (minPts = 15). 
In contrast, Munich shows a collapsed Pareto front, where both objectives deteriorate monotonically with increasing minPts, and Cologne yields a trivial, 
flat Pareto front characterized by near-complete coverage and almost constant directional cohesion across all parameter settings.”
